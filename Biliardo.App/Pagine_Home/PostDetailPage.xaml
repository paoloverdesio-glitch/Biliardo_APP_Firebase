<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:ui="clr-namespace:Biliardo.App.Componenti_UI"
             x:Class="Biliardo.App.Pagine_Home.PostDetailPage"
             Title="Post"
             BackgroundColor="#0B0B0B">

    <Grid RowDefinitions="Auto,*,Auto" Padding="10" RowSpacing="10">
        <Button Text="â†"
                WidthRequest="44"
                HeightRequest="44"
                BackgroundColor="#00000000"
                TextColor="White"
                Clicked="OnBackClicked" />

        <CollectionView Grid.Row="1"
                        ItemsSource="{Binding Comments}"
                        SelectionMode="None">
            <CollectionView.Header>
                <Border Stroke="#1F1F1F"
                        StrokeThickness="1"
                        BackgroundColor="#101010"
                        Padding="12"
                        Margin="0,0,0,10">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="14" />
                    </Border.StrokeShape>
                    <VerticalStackLayout Spacing="8">
                        <HorizontalStackLayout Spacing="10">
                            <ui:UserAvatarView AvatarUrl="{Binding Post.AuthorAvatarUrl}"
                                               AvatarPath="{Binding Post.AuthorAvatarPath}"
                                               DisplayName="{Binding Post.AuthorNickname}"
                                               Size="36" />
                            <VerticalStackLayout Spacing="2">
                                <Label Text="{Binding Post.AuthorNickname}" TextColor="White" FontAttributes="Bold" />
                                <Label Text="{Binding Post.CreatedAtLabel}" TextColor="#A0A0A0" FontSize="12" />
                            </VerticalStackLayout>
                        </HorizontalStackLayout>
                        <Label Text="{Binding Post.Text}" TextColor="White" />
                    </VerticalStackLayout>
                </Border>
            </CollectionView.Header>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Stroke="#1F1F1F"
                            StrokeThickness="1"
                            BackgroundColor="#0F0F0F"
                            Padding="10"
                            Margin="0,0,0,8">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12" />
                        </Border.StrokeShape>
                        <HorizontalStackLayout Spacing="10">
                            <ui:UserAvatarView AvatarUrl="{Binding AuthorAvatarUrl}"
                                               AvatarPath="{Binding AuthorAvatarPath}"
                                               DisplayName="{Binding AuthorNickname}"
                                               Size="28" />
                            <VerticalStackLayout Spacing="2">
                                <Label Text="{Binding AuthorNickname}" TextColor="White" FontAttributes="Bold" FontSize="12" />
                                <Label Text="{Binding Text}" TextColor="White" FontSize="12" />
                                <Label Text="{Binding CreatedAtLabel}" TextColor="#A0A0A0" FontSize="10" />
                            </VerticalStackLayout>
                        </HorizontalStackLayout>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Grid Grid.Row="2" ColumnDefinitions="*,Auto" ColumnSpacing="8">
            <Entry x:Name="CommentEntry"
                   Placeholder="Scrivi un commento"
                   TextColor="White"
                   PlaceholderColor="#A0A0A0"
                   BackgroundColor="#1C1C1C" />
            <Button Grid.Column="1"
                    Text="Invia"
                    BackgroundColor="#18A558"
                    TextColor="White"
                    Clicked="OnSendCommentClicked" />
        </Grid>
    </Grid>
</ContentPage>
